---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r}
## Unzipping the data, loading it into a data frame.
unzip("activity.zip")
data <- read.csv(file = "activity.csv", header = TRUE)

## Tries to remove the file from the hard disk after loading it. Returns a
## boolean value indicating wether it succesfully executed.
file.remove("activity.csv")

## Transforming days (as factors) into time variables - this does not take
## into account the time of day.
data$date <- strptime(data$date, format="%Y-%m-%d")
```

## What is mean total number of steps taken per day?
```{r}
## Define a new sum function that already removes the NA values.
newsum <- function(x){ sum(x,na.rm=TRUE)}

## Groups dates into factors by days.
stepsgroupedByDay <- split(data$steps,cut(data$date,breaks="day"))

## To compute the total number of steps per day we can split the number of steps
## according to the date labels and apply the newsum function.
totalStepsPerDay <- sapply(stepsgroupedByDay, newsum)
```
### Computing the median and mean of total number of steps per day
```{r}
mean(totalStepsPerDay)
median(totalStepsPerDay)
```


## What is the average daily activity pattern?
```{r}
## Note that the interval format is just recording the digits appearing in a
## digital clock, i.e. "1605" corresponds to 4.05 pm or 16:05

## Define a short hand version of the function mean(x, na.rm = TRUE)
newmean <- function(x){mean(x,na.rm =TRUE)}

## averageActivityPerDay computes the average number of steps, over 5 minute
## intervals, across all of the days in the data set.
averageActivityPerDay <-  sapply(split(data$steps,data$interval),newmean)
times <- as.numeric(names(averageActivityPerDay))
hours <- as.character( (times - times%%100)/100 )
minutes<- as.character(times %%100)
timeOfDay <- strptime(paste(hours,minutes,"00", sep =":"),format="%H:%M:%S")
```
### Constructing a plot of the averageActivityPerDay vs. the time of day.
```{r}
plot(timeOfDay,averageActivityPerDay, type ="l",xlab ="Time of Day",ylab="Average Steps per Day")
```
### Determining the interval(s) containing the largest average steps per day.
```{r}
highestAvgSteps <- max(averageActivityPerDay)
times[averageActivityPerDay==highestAvgSteps]
```

## Inputing missing values



## Are there differences in activity patterns between weekdays and weekends?
